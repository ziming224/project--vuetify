import{u as f,v as w,j as d,c as x,o as y,C as p,a as s,w as c,$ as u,H as g,E as k,a1 as F,a0 as U,F as P,N as q}from"./index-X5qswVBp.js";import{b as v}from"./route-block-B_A1xBdJ.js";const B={class:"text-center"},N={__name:"profile",setup(S){const n=f(),m=w(),r=d(!1),i=d(!1),l=d({account:n.account,email:n.email}),t={required:o=>!!o||"此欄位為必填",email:o=>/.+@.+\..+/.test(o)||"信箱格式不正確"},V=async()=>{var o,e;if(r.value){i.value=!0;try{await q.updateProfile({email:l.value.email}),n.email=l.value.email,m({text:"個人資料更新成功！",snackbarProps:{color:"success",location:"top"}})}catch(a){console.error("更新個人資料失敗",a);const b=((e=(o=a.response)==null?void 0:o.data)==null?void 0:e.message)||"更新失敗，請稍後再試";m({text:b,snackbarProps:{color:"error",location:"top"}})}finally{i.value=!1}}};return(o,e)=>(y(),x(P,null,[e[6]||(e[6]=p("h2",{class:"text-h5 font-weight-bold mb-4"},"個人資料",-1)),s(U,{modelValue:r.value,"onUpdate:modelValue":e[4]||(e[4]=a=>r.value=a),onSubmit:F(V,["prevent"])},{default:c(()=>[s(u,{modelValue:l.value.account,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.account=a),class:"mb-4",disabled:"",label:"帳號",readonly:"",variant:"outlined"},null,8,["modelValue"]),s(u,{modelValue:l.value.email,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.email=a),class:"mb-4",label:"變更信箱",rules:[t.required,t.email],type:"email",variant:"outlined"},null,8,["modelValue","rules"]),s(u,{modelValue:l.value.password,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.password=a),class:"mb-4",label:"原始密碼",rules:[t.required,t.minLength],type:"password",variant:"outlined"},null,8,["modelValue","rules"]),s(u,{modelValue:l.value.newPassword,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.newPassword=a),class:"mb-4",label:"變更密碼",rules:[t.required,t.minLength],type:"password",variant:"outlined"},null,8,["modelValue","rules"]),p("div",B,[s(g,{color:"tea",disabled:!r.value,loading:i.value,type:"submit"},{default:c(()=>e[5]||(e[5]=[k(" 儲存更新 ",-1)])),_:1,__:[5]},8,["disabled","loading"])])]),_:1},8,["modelValue"])],64))}};typeof v=="function"&&v(N);export{N as default};

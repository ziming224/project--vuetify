import{v as V,x as h,a8 as w,u as B,j as f,c as P,o as c,a as o,w as s,P as S,Q as b,z as C,K as l,H as u,q as v,as as N,f as E,G as i,E as p,B as I,s as T,F as j,M as q}from"./index-DGaisZJo.js";import{p as z}from"./product-XGI4FB6f.js";import{b as _}from"./route-block-B_A1xBdJ.js";const R={class:"text-h4 font-weight-bold mb-2"},F={class:"text-body-1 my-6",style:{"white-space":"pre-wrap"}},L={class:"text-h5 font-weight-bold mb-6"},M={class:"d-flex align-center ga-4"},O={__name:"[id]",setup(U){const n=V(),x=h(),m=w(),g=B(),r=f({name:"",price:0,description:"",category:"",sell:!0,image:""});(async()=>{try{const{data:t}=await z.getId(m.params.id);Object.assign(r.value,t.product),document.title=`${t.product.name} | 購物網站`}catch(t){console.error("Error fetching product:",t),n({text:"無法載入商品資料",snackbarProps:{color:"red"}}),x.push("/")}})();const d=f(1),y=async()=>{var t,e;try{const{data:a}=await q.cart({product:m.params.id,quantity:d.value});g.cartTotal=a.result,n({text:"已加入購物車",snackbarProps:{color:"green"}})}catch(a){const k=((e=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:e.message)||"無法加入購物車，請稍後再試";console.error("Error adding to cart:",a),n({text:k,snackbarProps:{color:"red"}})}};return(t,e)=>(c(),P(j,null,[o(I,null,{default:s(()=>[o(S,null,{default:s(()=>[o(b,{cols:"12",md:"6"},{default:s(()=>[o(C,{class:"rounded-lg",contain:"",height:"500","border-radius":"16",src:r.value.image},null,8,["src"])]),_:1}),o(b,{cols:"12",md:"6"},{default:s(()=>[l("h1",R,u(r.value.name),1),l("p",F,u(r.value.description),1),l("div",L," NT$ "+u(r.value.price.toLocaleString()),1),e[3]||(e[3]=l("p",null,"數量",-1)),l("div",M,[o(N,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=a=>d.value=a),"control-variant":"split",min:1,variant:"outlined",style:{"max-width":"200px"},"hide-details":""},null,8,["modelValue"]),E(g).isLoggedIn?(c(),v(i,{key:0,size:"large",color:"buttonBackground",disabled:!r.value.sell,"prepend-icon":"mdi-cart-plus",onClick:y},{default:s(()=>e[1]||(e[1]=[p(" 加入購物車 ",-1)])),_:1,__:[1]},8,["disabled"])):(c(),v(i,{key:1,size:"large",color:"buttonBackground","prepend-icon":"mdi-login",to:"/auth"},{default:s(()=>e[2]||(e[2]=[p(" 請先登入 ",-1)])),_:1,__:[2]}))])]),_:1,__:[3]})]),_:1})]),_:1}),o(T,{class:"align-center justify-center text-center","model-value":!r.value.sell,persistent:"",scrim:"black"},{default:s(()=>[e[5]||(e[5]=l("h1",{class:"text-h2 font-weight-bold mb-4"},"已下架",-1)),e[6]||(e[6]=l("p",{class:"text-h6 mb-8"},"這個商品已經下架，無法購買。",-1)),o(i,{color:"accent",to:"/"},{default:s(()=>e[4]||(e[4]=[p(" 返回首頁 ",-1)])),_:1,__:[4]})]),_:1,__:[5,6]},8,["model-value"])],64))}};typeof _=="function"&&_(O);export{O as default};

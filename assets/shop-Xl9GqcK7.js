import{g as C,S as N}from"./ScrollTrigger-CUwdeFQJ.js";import{j as u,m as O,c as y,o as c,a as t,w as a,C as l,I as n,W as R,y as F,u as G,q as S,$ as X,aC as Y,E as p,a3 as Z,g as H,a7 as ee,G as te,H as j,a2 as ae,R as q,v as oe,k as I,aD as re,f as se,P as _,Q as d,S as le,B as U,aE as ne,ar as B,F as b,h as L,a0 as ce,aF as ie,d as de,e as ue,ap as me,aG as D,aH as fe,aI as pe,N as ge}from"./index-CgVb7Qfs.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{p as ve}from"./product-ufwgmITs.js";import{b as M}from"./route-block-B_A1xBdJ.js";const _e=""+new URL("dog-face-BvL0_U8h.jpg",import.meta.url).href,ye={class:"hero-text"},he={class:"text-h2 font-weight-bold"},xe={class:"text-h5 font-weight-bold"},Ve={__name:"HeroSection",props:{imageSrc:{type:String,required:!0},title:{type:String,default:"公益商城"},subtitle:{type:String,default:"每月與不同單位合作您下的一筆訂單能讓毛孩們多一份溫飽"}},setup(s){const m=u(null);return O(()=>{C.registerPlugin(N);const f=m.value;C.fromTo(f,{scale:1,y:0},{scale:.5,y:-200,transformOrigin:"top center",scrollTrigger:{trigger:f,start:"top top",end:"bottom top",scrub:!0,pin:!0,pinSpacing:!1}})}),(f,g)=>(c(),y("div",{ref_key:"heroSection",ref:m,class:"hero-section"},[t(R,{class:"hero-img",cover:"",src:s.imageSrc},{default:a(()=>[l("div",ye,[l("h1",he,n(s.title),1),l("p",xe,n(s.subtitle),1)])]),_:1},8,["src"])],512))}},ke=E(Ve,[["__scopeId","data-v-8cd66faa"]]),be={class:"text-h6 font-weight-bold text-secondary my-2"},Se={class:"text-body-2 product-description"},Ce={__name:"ProductCard",props:["_id","image","name","category","price","description"],emits:["add-to-cart"],setup(s,{emit:m}){const f=s,g=m,T=F();G();const w=()=>{g("add-to-cart")},h=()=>{T.push("/product/"+f._id)};return(x,i)=>(c(),S(q,{class:"d-flex flex-column product-card",height:"100%",hover:"",name:"",onClick:h},{default:a(()=>[t(R,{class:"text-white align-end",cover:"",height:"450",src:s.image},{default:a(()=>[t(X,{color:"rgba(0, 0, 0, 0.4)",theme:"dark"},{default:a(()=>[t(Y,{class:"text-body-1 font-weight-bold"},{default:a(()=>[p(n(s.name),1)]),_:1})]),_:1})]),_:1},8,["src"]),t(Z,{class:"pt-4 flex-grow-1"},{default:a(()=>[l("div",be," NT$ "+n(s.price.toLocaleString()),1),l("div",Se,n(s.description),1)]),_:1}),t(H),t(ee,{class:"pa-3"},{default:a(()=>[t(te),t(j,{color:"secondary","prepend-icon":"mdi-cart-plus",text:"加入購物車",variant:"tonal",onClick:ae(w,["prevent"])})]),_:1})]),_:1}))}},Te=E(Ce,[["__scopeId","data-v-f3898a6b"]]),we={class:"mb-1 text-h6"},Pe={class:"text-secondary"},$e={class:"text-medium-emphasis mb-0"},A=9,W={__name:"shop",setup(s){const m=u({name:"浪浪狗狗之家",description:"致力於救援與照顧流浪動物"}),f=u(null),g=oe(),T=G(),w=F(),h=u([]),x=I(()=>h.value.filter(r=>{const o=r.name.toLowerCase().includes(P.value.toLowerCase()),e=V.value?r.category===V.value:!0;return o&&e}).sort((r,o)=>{const e=$[k.value];return e.key==="createdAt"||e.key==="updatedAt"?e.direction*(new Date(r[e.key])-new Date(o[e.key])):e.direction*(r[e.key]>o[e.key]?1:-1)})),i=u(1),z=I(()=>Math.ceil(x.value.length/A)),Q=I(()=>x.value.slice((i.value-1)*A,i.value*A)),P=u(""),V=u(""),J=["貓用","犬用"],k=u(0),$=[{text:"名稱",key:"name",direction:1},{text:"價格：低到高",key:"price",direction:1},{text:"價格：高到低",key:"price",direction:-1},{text:"最新商品",key:"createdAt",direction:-1},{text:"最舊商品",key:"createdAt",direction:1}];(async()=>{try{const{data:r}=await ve.get();h.value=r.products}catch(r){console.error("Error fetching products:",r),g({text:"無法載入商品資料",snackbarProps:{color:"red"}})}})();const K=async r=>{var o,e;if(!T.isLogin){w.push("/auth");return}try{await ge.cart({product:r,quantity:1}),g({text:"已加入購物車",snackbarProps:{color:"success"}})}catch(v){g({text:((e=(o=v.response)==null?void 0:o.data)==null?void 0:e.message)||"加入購物車失敗",snackbarProps:{color:"red"}})}};return C.registerPlugin(N),O(()=>{window.scrollTo(0,0);const r=f.value,o=C.fromTo(r,{scale:1,y:0},{scale:.5,y:-200,transformOrigin:"top center",scrollTrigger:{trigger:r,start:"top top",end:"bottom top",scrub:!0,pin:!0,pinSpacing:!1}});re(()=>{var e;(e=o.scrollTrigger)==null||e.kill()})}),(r,o)=>(c(),y(b,null,[t(ke,{"image-src":se(_e),subtitle:"每月與不同單位合作您下的一筆訂單能讓毛孩們多一份溫飽",title:"公益商城"},null,8,["image-src"]),t(U,{class:"announcement-container my-8",fluid:""},{default:a(()=>[t(_,{justify:"center"},{default:a(()=>[t(d,{cols:"12",md:"8"},{default:a(()=>[t(q,{class:"pa-4 announcement-card",elevation:"4"},{default:a(()=>[t(_,{align:"center","no-gutters":""},{default:a(()=>[t(d,{class:"text-center",cols:"2"},{default:a(()=>[t(le,{color:"secondary",size:"48"},{default:a(()=>o[5]||(o[5]=[p("mdi-bullhorn",-1)])),_:1,__:[5]})]),_:1}),t(d,{cols:"10"},{default:a(()=>[o[7]||(o[7]=l("h2",{class:"mb-2 text-h4"},"本月公益合作捐贈單位",-1)),o[8]||(o[8]=l("p",{class:"text-body-1"}," 在本賣場消費之商品都會捐贈與該月合作單位，每月合作對象以公告單位為準。 ",-1)),l("p",we,[o[6]||(o[6]=p(" 💝 本月商品將捐贈給 ",-1)),l("strong",Pe,n(m.value.name),1)]),l("p",$e,n(m.value.description),1)]),_:1,__:[7,8]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(U,null,{default:a(()=>[t(_,{align:"center",class:"mb-4"},{default:a(()=>[t(d,{cols:"12",md:"8"},{default:a(()=>[t(ne,{modelValue:V.value,"onUpdate:modelValue":[o[0]||(o[0]=e=>V.value=e),o[1]||(o[1]=e=>i.value=1)],mandatory:"","selected-class":"text-secondaryary"},{default:a(()=>[t(B,{filter:"",value:"",variant:"outlined"},{default:a(()=>o[9]||(o[9]=[p(" 全部 ",-1)])),_:1,__:[9]}),(c(),y(b,null,L(J,e=>t(B,{key:e,filter:"",value:e,variant:"outlined"},{default:a(()=>[p(n(e),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(d,{class:"d-flex align-center",cols:"12",md:"4"},{default:a(()=>[t(ce,{modelValue:P.value,"onUpdate:modelValue":[o[2]||(o[2]=e=>P.value=e),o[3]||(o[3]=e=>i.value=1)],class:"mr-2",clearable:"",density:"compact",flat:"","hide-details":"",placeholder:"搜尋商品","prepend-inner-icon":"mdi-magnify",variant:"solo-filled"},null,8,["modelValue"]),t(ie,null,{activator:a(({props:e})=>[t(j,D(e,{icon:"mdi-sort",ripple:!1,variant:"text"}),null,16),p(" "+n($[k.value].text),1)]),default:a(()=>[t(de,null,{default:a(()=>[(c(),y(b,null,L($,(e,v)=>t(ue,{key:e.text,active:k.value===v,onClick:Le=>{k.value=v,i.value=1}},{default:a(()=>[t(me,null,{default:a(()=>[p(n(e.text),1)]),_:2},1024)]),_:2},1032,["active","onClick"])),64))]),_:1})]),_:1})]),_:1})]),_:1}),t(H,{class:"mb-8"}),x.value.length>0?(c(),S(_,{key:0},{default:a(()=>[(c(!0),y(b,null,L(Q.value,e=>(c(),S(d,{key:e._id,cols:"12",lg:"4",md:"6"},{default:a(()=>[t(Te,D({ref_for:!0},e,{onAddToCart:v=>K(e._id)}),null,16,["onAddToCart"])]),_:2},1024))),128)),t(d,{cols:"12"},{default:a(()=>[t(fe,{modelValue:i.value,"onUpdate:modelValue":o[4]||(o[4]=e=>i.value=e),circle:"",length:z.value,"total-visible":5},null,8,["modelValue","length"])]),_:1})]),_:1})):(c(),S(_,{key:1},{default:a(()=>[t(d,{cols:"12"},{default:a(()=>[t(pe,{headline:"噢！找不到商品",icon:"mdi-magnify-remove-outline",text:"試試看更換篩選條件或關鍵字吧！",title:"無符合條件的商品"})]),_:1})]),_:1}))]),_:1})],64))}};typeof M=="function"&&M(W);const Me=E(W,[["__scopeId","data-v-7f71fca7"]]);export{Me as default};
